# 제품 요구 사항 문서 (PRD) – 오프라인 멀티모달 챗봇 앱

## 1. 개요
본 앱은 사용자의 스마트폰 CPU·GPU를 활용해 오프라인에서도 동작하는 멀티모달 챗봇이다. Google Gemma 3n 모델을 온디바이스로 탑재해 텍스트·이미지·음성 입력을 처리하며, 온라인 환경에서는 Upstage Solar Pro 2 모델로 확장된 성능을 제공한다. 데이터 비용과 개인정보 노출 우려를 최소화하며, 언제 어디서나 AI를 활용하고 싶은 이용자에게 경제적·편리한 경험을 제공한다.

## 2. 문제 정의
- 클라우드 기반 AI 서비스는 지속적 네트워크 연결·구독 비용이 필요하다.  
- 오프라인 환경(비행기, 산간, 해외 로밍 제한)에서는 챗봇 사용이 불가하다.  
- 개인정보 및 민감 데이터가 서버로 전송되어 보안·프라이버시 우려가 존재한다.

## 3. 목표 및 목적
- 1차 목표: 네트워크 미연결 상태에서도 자연스러운 대화·멀티모달 이해·생성을 지원.  
- 2차 목표: 온라인 연결 시 상위 모델로 자동 전환해 정확도·속도 향상.  
- 성공 지표  
  - DAU 10만 명(출시 6개월)  
  - 세션당 평균 응답 시간 오프라인 2초 이하  
  - 유료 광고 없음 기준 월 유지율 40% 이상  
  - NPS 50 이상  

## 4. 타깃 사용자
### 주요 사용자
- 데이터 요금·프라이버시 민감한 20~40대 스마트폰 사용자  
- 비행 승무원, 군인, 해외 출장 잦은 직장인  
- 개발자·학생 등 AI 탐구·테스트 목적으로 로컬 실행을 원하는 층  

### 이차 사용자
- 오프라인 환경 대상 B2B 사업자(교육, 의료, 제조 현장)  
- 통신 불안정 지역 지자체·NGO  

## 5. 사용자 스토리
- “여행 중 기내에서, 나는 인터넷 없이도 영어 회화 교정을 받고 싶다.”  
- “보안 구역 근무자로서, 외부 서버로 데이터 유출 없이 문서를 요약하고 싶다.”  
- “사진을 찍어 재료를 인식하고 요리 레시피를 즉시 받아보고 싶다.”  
- “온라인 연결 시 더 빠른 응답을 위해 클라우드 모델로 자동 전환되길 원한다.”  

## 6. 기능 요구사항
### 핵심 기능
1. 오프라인 모델 실행  
   - 설명: Gemma 3n(≈3B 파라미터) 로컬 추론. 텍스트, 이미지, 음성 입력 지원.  
   - 수용 기준  
     - 디바이스 RAM 6GB 이상에서 추론 오류 1% 이하  
     - 텍스트 50토큰 기준 응답 ≤2초  

2. 온라인 모델 전환  
   - 설명: 네트워크 감지 시 Solar Pro 2 API 호출로 품질·속도 최적.  
   - 수용 기준  
     - 전환 시 세션 유지(컨텍스트 손실 0건)  
     - 응답 품질 BLEU/ROUGE 10% ↑(오프라인 대비)  

3. 모달 통합 UI  
   - 설명: 텍스트 입력, 마이크, 카메라 버튼 통합. 입력 형태 자동 감지.  
   - 수용 기준  
     - 이미지 인식 정확도 85%↑  
     - 음성 인식 WER ≤7%  

4. 프라이버시 모드  
   - 설명: 모든 데이터 오프라인 저장, 암호화(Apple Secure Enclave).  
   - 수용 기준  
     - OWASP Mobile Top10 취약점 0건  

### 지원 기능
- 대화 히스토리 로컬 검색·태그  
- 모델 관리(ON/OFF, 용량 확인)  
- 배터리 세이브 모드(저전력 시 추론 양 줄이기)  
- 다국어 UI(한국어 기본, 영어·일본어)  

### Nice-to-Have 제안
- 온디바이스 파인튜닝(사용자 문체 학습)  
- Apple Vision Pro 대응 공간 컴퓨팅 UI  
- 커뮤니티 공유 프롬프트 마켓플레이스  

## 7. 비기능 요구사항
- 성능: iPhone 12 기준 초반 로딩 ≤5초, FPS 30↑(카메라).  
- 보안: Keychain 기반 토큰 저장, TLS 1.3, offline 모드 완전 차단(외부 전송).  
- 사용성: iOS Human Interface Guidelines 준수, 다크모드 100%.  
- 확장성: Core ML 모델 교체를 고려한 모듈형 구조.  
- 호환성: iOS 15+, iPadOS, Apple Silicon Mac(유니버설).  

## 8. 기술 고려사항
- 아키텍처: Swift + SwiftUI, MVVM, Combine.  
- 온디바이스 추론: Metal Performance Shaders, Core ML Stable Diffusion pipeline 변형.  
- 모델 압축: 4bit quantization, LoRA adapter.  
- 음성: Apple Speech framework, offline acoustic model.  
- 이미지: VisionKit + Core ML.  
- 서버: Online 모드용 RESTful API(GRPC 준비).  
- 데이터: 로컬 Realm DB, iCloud 백업 선택적.  
- 서드파티: Upstage Solar Pro 2, Firebase Crashlytics(익명).  

```swift
// 예시 모델 로딩 코드
let config = MLModelConfiguration()
config.computeUnits = .cpuAndNeuralEngine
let gemma = try MLModel(contentsOf: gemmaURL, configuration: config)
```

## 9. 성공 측정 지표
- 기술: 평균 응답 시간, 모델 전환 성공률 99%↑  
- 사용자: 세션당 평균 대화 수 8회↑, 일간 재방문율 60%↑  
- 비즈니스: 광고/구독 전환율 5%, 서버 비용 대비 ROI 300%  

## 10. 일정 및 마일스톤
- 1단계(M0~M2) MVP  
  - Gemma 3n 통합, 텍스트 대화, 기본 UI  
- 2단계(M3~M5) 멀티모달·온라인 전환  
  - 이미지·음성, Solar Pro 2 API, 배포 TestFlight  
- 3단계(M6~M8) 글로벌 출시  
  - 다국어, 파인튜닝, 구독 모델, 마켓플레이스 베타  

## 11. 위험 및 대응
- 모델 크기 과대 → 4bit 압축·옵션 다운로드  
- 배터리 소모 → 프레임 줄임, GPU Scheduling  
- 앱스토어 심사 거절(저장 공간) → Lite 버전 배포  
- 법적 규제(개인정보) → 온디바이스 저장·삭제 옵션 제공  

## 12. 향후 고려 사항
- Android·Windows 포팅(Kotlin, Electron)  
- Federated Learning으로 사용자 피드백 반영  
- 웨어러블(Watch, CarPlay) 확장  
- LLM+검색(RAG) 통합 오프라인 코사이니드 인덱스 구축  